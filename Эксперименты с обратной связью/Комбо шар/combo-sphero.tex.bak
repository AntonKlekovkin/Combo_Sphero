\documentclass[10pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{amsmath,amssymb,amscd, amsfonts,amsthm}
%\usepackage{cite}
\usepackage{graphicx}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
%\usepackage{rcdcom}
\graphicspath{{pictures/}}

\newcommand{\bs}{\boldsymbol}
\newcommand{\bV}{\bs V}
\newcommand{\bF}{\bs F}
\newcommand{\bOm}{\bs\Omega}
\newcommand{\bK}{\bs K}
\newcommand{\bQ}{\bs Q}
\newcommand{\bR}{\bs R}
\newcommand{\bN}{\bs N}
\newcommand{\bI}{\bs I}
\newcommand{\x}{\times}
\newcommand{\lm}{\lambda}
\newcommand{\Om}{\Omega}
\newcommand{\om}{\omega}
\newcommand{\q}{\quad}

\begin{document}

\bigskip
\begin{center}
{\Large \bf Управление комбинированным сферороботом с обратной связью}
\end{center}

\section{Введение}

%\qquad На сегодняшний день существует большое количество работ, посвященных сферическим роботам. Подробные обзоры конструкций и принципов приведения в движение можно найти в работах \cite{OmniwheelSphero}. Наиболее популярными способами реализации движения сферических роботов являются изменение положения центра масс и изменение внутреннего гиростатического момента.

%Теоретические исследования динамики сфероробота комбинированного типа, использующего для движения как смещение центра масс, так и изменение гиростатического момента, катящегося без проскальзывания по горизонтальной плоскости, проведены в работе \cite{ComboSpheroTheory}. В работе \cite{ComboSphero} были проведены экспериментальные исследования, была доказана возможность управления сферическим роботом комбинированного типа. При проведении экспериментов было отмечено, что введение в систему управления обратных связей позволит повысить эффективность управления и устойчивость движения. Теоретическое исследование модели управления сфероробота комбинированного типа с обратной связью, рассмотрена в работе \cite{}, также было проведено компьютерное моделирование движения, которое показало эффективность предложенной модели. В предлагаемом подходе обратная связь зависит от фазовых переменных (текущего положения, скоростей) и не зависит от конкретного вида траектории. В данной работе мы проведем экспериментальные исследования, на основе теоретических данных введем в систему управления обратные связи и покажем как это влияет на движение сфероробота.


\section{Экспериментальное исследование движения сфероробота с обратными связями}

\qquad В работах \cite{ComboSpheroFeedback1, ComboSpheroFeedback2} рассмотрено управление сферороботом комбинированного типа с обратной связью, стабилизирующей заданные частные решения для свободной системы на конечном этапе движения. В рассмотренном подходе обратная связь зависит от текущего положения и скоростей сфероробота, не зависит от конкретного вида траектории, и заключается в вычислении управляющих моментов $K_{\vartheta}$ и $K_{\varphi}$ в виде

\begin{equation}
K_{\vartheta} = \tilde{k_{\vartheta}}(\dot{\vartheta} + \frac{v^*}{R_s}), \quad
K_{\varphi} = \tilde{k_{\varphi}}(\bOm, e_2+e_3),
\label{torque_wheels}
\end{equation}

где $\tilde{k}_{\vartheta}, \tilde{k}_{\varphi}$ -- постоянные коэффициенты; $\vartheta$ -- угол поворота маятника вокруг оси $e_1$ в подвижной системе координат;
%$\varphi$ -- угол поворота ротора вокруг оси $e_3$ в подвижной системе координат,
$R_s$ -- радиус сферической оболочки; $v^*$ -- заданное значение линейной скорости качения сфероробота после стабилизации движения; $\bOm$ -- угловая скорость вращения оболочки.

Результаты моделирования движения сфероробота комбинированного типа, приведенные в \cite{ComboSpheroFeedback1, ComboSpheroFeedback2} с учетом обратной связи, подтверждают возможность стабилизации сфероробота, однако, вопрос выбора и обоснования значений коэффициентов $\tilde{k}_{\vartheta}$ и  $\tilde{k}_{\varphi}$ остается не раскрытым. На практике определение значений данных коэффициентов имеет ключевое значение.

\subsection{Особенности технической реализации управления с обратными связями}

Для определения значений коэффициентов $\tilde{k}_{\vartheta}$ и  $\tilde{k}_{\varphi}$ проведем исследование предложенного алгоритма стабилизации сфероробота комбинированного типа для реальной модели сфероробота (см. рис.~\ref{sphero}), разработанной в лаборатории нелинейного анализа и новых средств передвижения Удмуртского государственного университета (см. работу \cite{ComboSphero}). Фото лабораторной модели сфероробота комбинированного типа представлено на рисунке \ref{sphero}.

\begin{figure}[!h]
\centering\includegraphics[width=0.3\linewidth]{sphero.eps}
\caption{Лабораторная модель сфероробота комбинированного типа.\label{sphero}}
\end{figure}

Данная модель сфероробота комбинированного типа приводится в движение колесной тележкой, перемещающейся в экваториальной плоскости сферической оболочки $R_s=0.15$ м по ободу, имеющему специальный профиль. На колесной тележке ротор расположен так, что его ось вращения направлена вдоль радиуса сферической оболочки. Вращение ротора используется для поворота сферического робота и реализуется двигателем постоянного тока, обеспечивающим необходимый момент $K_{\varphi}$. Каждое колесо приводится в движение отдельным двигателем постоянного тока, обеспечивающим необходимый момент $K_{\vartheta}$, а для синхронизации скоростей используются датчики угла поворота колес, установленные на выходных валах приводных двигателей.

Уравнения (\ref{torque_wheels}) предполагают линейную зависимость необходимых моментов от отклонения фазовых переменных, что на практике возможно реализовать только на конечном интервале из-за ограниченности кинематического момента, который могут обеспечить двигатели постоянного тока. Удобнее записать уравнения (\ref{torque_wheels}) в следующем виде

\begin{equation}
K_{\vartheta} = \frac{2 K_{max}}{\pi}arctg((\dot{\vartheta}+\frac{v^*}{R_s})\zeta_{\vartheta}), \quad
K_{\varphi} = \frac{2 K_{max}}{\pi}arctg((\bOm, e_2+e_3)\zeta_{\varphi}),
\label{torque_wheels2}
\end{equation}

где $\zeta_{\vartheta}, \zeta_{\varphi}$ -- коэффициенты регуляторов; $K_{max}$ -- максимальный момент, обеспечиваемый двигателем.

Контроль за текущим значением кинематических моментов на практике реализуется с помощью измерения тока в двигателях, так как зависимость момента от тока определяется выражением $K=C_T\cdot i$, где $K$ -- момент на выходном валу двигателя; $i$ -- ток, проходящий через двигатель; $C_T$ -- постоянная момента. Для выбранных двигателей постоянного тока $C_T=0.963$ Нм/А,  $i_{max}=1$ А -- максимальное значение тока, при котором обеспечивается максимальный момент двигателя. Тогда с учетом (\ref{torque_wheels2}), управляющие воздействия, стабилизирующие движение сфероробота комбинированного типа запишутся в виде

\begin{equation}
i_{\vartheta} = 0.661arctg((\dot{\vartheta}+\frac{v^*}{R_s})\zeta_{\vartheta}), \quad
i_{\varphi} = 0.661arctg((\bOm, e_2+e_3)\zeta_{\varphi}),
\label{torque_wheels3}
\end{equation}

где $i_{\vartheta}$ и $i_{\varphi}$ -- управляющие токи двигателя, вращающего колеса, и двигателя, вращающего ротор, соответственно.

Для измерения тока каждого из двигателей ($i_{\vartheta}$ и $i_{\varphi}$) сфероробота комбинированного типа используется линейный датчик тока на базе эффекта Холла -- ACS712. Для поддержания заданного значения тока реализован регулятор, обеспечивающий его изменение пропорционально величине отклонения реального значения величины тока от заданной.

%\begin{table}[!h]
%\caption{Основные характеристики сферического робота}
%\label{table1}
%\begin{center}
%\begin{tabular}{|c|c|c|}
%\hline
%Характеристика & Обозначение & Значение \\
%\hline
%Радиус сферы: & $R_s$ & $0.15$ м\\
%Масса сферы: & $m_s$ & $1.625$ кг \\
%Тензор инерции сферы: & $\bI_s$ & $diag(25.27\cdot10^{-3}, 20.73\cdot10^{-3}, 25.27\cdot10^{-3})$ кг$\cdot$м$^2$ \\
%Радиус ротора: & $R_r$ & $0.087$ м\\
%Масса ротора: & $m_r$ & $2.46$ кг\\
%Осевой момент инерции ротора: & $I_r$ & $5.64\cdot10^{-3}$ кг$\cdot$м$^2$ \\
%Масса тележки с ротором: & $m_b$ & $3.25$ кг\\
%Тензор инерции тележки с ротором: & $\bI_b$ & $diag(31.88\cdot10^{-3}, 30.59\cdot10^{-3}, 8.76\cdot10^{-3})$ кг$\cdot$м$^2$ \\
%\hline
%\end{tabular}
%\end{center}
%\end{table}

%Стабилизация движения сфероробота комбинированного типа в соответствии в выражениями (\ref{torque_wheels}) предполагает управление кинетическими моментами $K_{\vartheta}$ и $K_{\varphi}$ соответствующих приводов. Техническое управление моментами осуществляется по измеряемому току в двигателях, так как $K=c\cdot i$, где $c=0.003???$

Тогда общая структурная схема регуляторов для стабилизации движения сфероробота будет иметь два контура регулирования (см. рис.~\ref{pid}). Внешний контур отвечает за регулирование угловых скоростей сфероробота, на выходе которого получаем величину тока, которую необходимо поддерживать. Внутренний контур обеспечивает регулирование тока, а соответственно и величину момента на валу каждого из двигателей на заданном уровне.

\begin{figure}[!h]
\centering\includegraphics[width=0.8\linewidth]{pid.eps}
\caption{Схема регуляторов стабилизации движения сфероробота.\label{pid}}
\end{figure}

На рисунке~\ref{pid}: $\bOm_{set}$ -- вектор заданной угловой скорости сфероробота комбинированного типа, $\bOm_{act}$ -- вектор фактической угловой скорости, $i_{\vartheta}, i_{\varphi}$ -- заданные значения тока для двигателя колес и двигателя ротора соответственно, $\hat{i}_{\vartheta}, \hat{i}_{\varphi}$ -- фактические значения тока, протекающего через двигатель колес и двигатель ротора соответственно, $U_{\vartheta}, U_{\varphi}$ -- значения напряжений, подаваемые на двигатель колес и двигатель ротора соответственно.

Для измерения угловых скоростей $\bOm_{now}$ сфероробота используется девятиосевой сенсор движения -- MPU9250, который содержит трехосевой гироскоп, трехосевой акселерометр и трехосевой магнитометр.

Далее рассмотрим особенности определения значений коэффициентов $\zeta_{\vartheta}$ и $\zeta_{\varphi}$ на практике.

Для исключения взаимного влияния контуров обратной связи проведем исследование частных случаев движения, при которых рассматриваемые управления задействованы по отдельности.

Из выражений (\ref{torque_wheels3}) следует, что коэффициент $\zeta_{\vartheta}$ используется в регуляторе, обеспечивающем минимизацию отклонения от вертикали в плоскости движения сфероробота при движении по прямой. Поэтому для определения его оптимального значения будем использовать компоненту $\gamma_3$. А для определения оптимального значения коэффициента $\zeta_{\varphi}$ будем использовать компоненту $\alpha_1$, так как коэффициент $\zeta_{\varphi}$ отвечает за отклонение сфероробота от первоначального курса.

Для восстановления траектории движения сфероробота ($x,y,z$) и его ориентации ($\bs \alpha, \bs \beta, \bs \gamma$) использовалась система захвата движения фирмы Vicon, где $\bs \alpha, \bs \beta, \bs \gamma$ -- векторы проекций ортов неподвижной системы координат на оси подвижной системы координат.

1. Определение коэффициента $\zeta_{\vartheta}$.

Репрезентативной траекторией движения сфероробота комбинированного типа для определения коэффициента $\zeta_{\vartheta}$ является прямая. Движение вдоль прямой обеспечивается уравнением $K_{\vartheta}$, а ротор остается неподвижным, т.е. $K_{\varphi}=0$.

Отклонение сфероробота при движении вдоль прямой формируется тем, что на его пути (см. рисунок \ref{barrier}) устанавливается препятствие (высотой 5 мм и длиной 600 мм), преодолевая которое, сфероробот совершает колебания в плоскости, параллельной направлению движения.

\begin{figure}[!h]
\centering\includegraphics[width=0.5\linewidth]{barrier.eps}
\caption{Препятствие на пути движения робота.\label{barrier}}
\end{figure}

Типовые отклонения сфероробота в процессе его движения при преодолении препятствия в виде колебаний компоненты $\gamma_3$ показаны на рисунке~\ref{feedback_line} пунктирной линией.

Для одинаковых начальных условий, но при различных значениях коэффициента $\zeta_{\vartheta}\in[1;4]$ проведено $N$ серий экспериментов. Для каждого значения коэффициента $\zeta_{\vartheta}$ вычислялась интегральная ошибка для всех экспериментов в рамках одной серии

\begin{equation}
\sigma_{\gamma_3}=\sum_{j=1}^N \sqrt{\frac{\sum\limits_{i=1}^n(\gamma_{3_i}^j -1)^2}{n-1}} \cdot \frac{1}{N},
\label{sigma}
\end{equation}

где $n$~-- количество точек, полученных при захвате траектории движения для отдельного эксперимента; $N$~-- количество экспериментов в серии; $j$~-- номер эксперимента.

На рисунке~\ref{zeta} показана зависимость интегральной ошибки $\sigma_{\gamma_3}$ от значения коэффициента $\zeta_{\vartheta}$. Минимуму ошибки соответствует значение $\zeta_{\vartheta}=2$.

\begin{figure}[!h]
\centering\includegraphics[width=0.5\linewidth]{zeta.eps}
\caption{Зависимость интегральной ошибки $\sigma_{\gamma_3}$ от значения коэффициента $\zeta_{\vartheta}$.\label{zeta}}
\end{figure}

Изменение компоненты $\gamma_3$ при стабилизации движения сфероробота комбинированного типа, используя~(\ref{torque_wheels3}), приведено на рисунке~\ref{feedback_line} сплошной линией, где $\zeta_{\vartheta}=2, \zeta_{\varphi}=0, v^*=0.3$ м/с.


\begin{figure}[!h]
\centering\includegraphics[width=1\linewidth]{feedback_line.eps}
\caption{Изменение компоненты $\gamma_3$ при движении сфероробота комбинированного типа по прямой и преодолении препятствия: сплошная линия -- $\gamma_3$ при $\zeta_{\vartheta}=2, \zeta_{\varphi}=0, v^*=0.3$ м/с, штриховая линия -- $\gamma_3$ при $\zeta_{\vartheta}=0, \zeta_{\varphi}=0, v^*=0.3$ м/с (без обратной связи)\label{feedback_line}}
\end{figure}

Интегральная ошибка $\sigma_{\gamma_3}$ для приведенных данных от идеального значения для экспериментов с обратной связью $\sigma_{\gamma_3}=0.025$, для экспериментов без обратной связи -- $\sigma_{\gamma_3}=0.078$. Уменьшение ошибки более чем в 3 раза позволяет сделать вывод о работоспособности регулятора.

2. Определение коэффициента $\zeta_{\varphi}$.

Аналогично вышеописанному эксперименту рассмотрим траекторию движения сфероробота комбинированного типа для определения коэффициента $\zeta_{\varphi}$ в виде прямой. Но препятствие (высотой 3 мм и длиной 25 мм) установлено таким образом (см. рисунок \ref{barrier2}), что, преодолевая его, сфероробот отклоняется от первоначального направления движения.

\begin{figure}[!h]
\centering\includegraphics[width=0.5\linewidth]{barrier2.eps}
\caption{Препятствие на пути движения робота.\label{barrier2}}
\end{figure}

Типовые отклонения сфероробота в процессе его движения при преодолении препятствия в виде колебаний компоненты $\alpha_1$ показаны на рисунке~\ref{compareAlpha} пунктирной линией.

Для одинаковых начальных условий, но при различных значениях коэффициента $\zeta_{\varphi}\in[0.1;0.3]$ проведено $N$ серий экспериментов. Для каждого значения коэффициента $\zeta_{\varphi}$ вычислялась интегральная ошибка для всех экспериментов в рамках одной серии

\begin{equation}
\sigma_{\alpha1}=\sum_{j=1}^N \sqrt{\frac{\sum\limits_{i=1}^n(\alpha_{1_i}^j -1)^2}{n-1}} \cdot \frac{1}{N},
\label{sigma}
\end{equation}

где $n$ -- количество точек, полученных при захвате траектории движения для отдельного эксперимента; $N$ -- количество экспериментов в серии; $j$ -- номер эксперимента.

На рисунке~\ref{zeta_phi} показана зависимость интегральной ошибки $\sigma_{\alpha_1}$ от значения коэффициента $\zeta_{\varphi}$. Минимуму ошибки соответствует значение $\zeta_{\varphi}=0.15$.

\begin{figure}[!h]
\centering\includegraphics[width=0.5\linewidth]{zeta_phi.eps}
\caption{Зависимость интегральной ошибки $\sigma_{\alpha1}$ от значения коэффициента $\zeta_{\varphi}$\label{zeta_phi}}
\end{figure}

Изменение компоненты $\alpha_1$ при стабилизации движения сфероробота комбинированного типа, используя (\ref{torque_wheels3}), приведено на рисунке~\ref{compareAlpha} сплошной линией, где $\zeta_{\vartheta}=0, \zeta_{\varphi}=0.15, v^*=0.3$ м/с.

\begin{figure}[!h]
\centering\includegraphics[width=1\linewidth]{compareAlpha.eps}
\caption{Изменение компоненты $\alpha_1$ при движении сфероробота комбинированного типа по прямой и преодолении препятствия: сплошная линия -- $\alpha_1$ при $\zeta_{\vartheta}=0, \zeta_{\varphi}=0.15, v^*=0.3$ м/с, штриховая линия -- $\alpha_1$ при $\zeta_{\vartheta}=0, \zeta_{\varphi}=0, v^*=0.3$ м/с (без обратной связи)\label{compareAlpha}}
\end{figure}

Интегральная ошибка $\sigma_{\alpha_1}$ для приведенных данных от идеального значения для экспериментов с обратной связью $\sigma_{\alpha_1}=0.033$, для экспериментов без обратной связи $\sigma_{\alpha_1}=0.097$. Уменьшение ошибки приблизительно в 3 раза позволяет сделать вывод о работоспособности регулятора.

Далее рассмотрим результаты экспериментов при совместном использовании регуляторов при оптимальных значениях их коэффициентов.


\section{Сравнение движений с обратной связью и без нее}

\qquad Рассмотрим движение робота по прямой, аналогичное движению в экспериментах по определению оптимального коэффициента $\zeta_{\varphi}$. Типовые отклонения сфероробота в процессе его движения при преодолении препятствия в виде колебаний компонент $\gamma_3$ и $\alpha_1$ показаны пунктирной линией на рисунках~\ref{feedback_general}а и ~\ref{feedback_general}б соответственно. Траектория движения сфероробота показана на рисунке~\ref{generalTrajectory} пунктирной линией.

Проведено две серии экспериментов с одинаковыми начальными условиями. Изменение компонент $\gamma_3$ и $\alpha_1$ при стабилизации движения сфероробота комбинированного типа, используя (\ref{torque_wheels3}), приведено сплошной линией на рисунках~\ref{feedback_general}а и~\ref{feedback_general}б соответственно, где $\zeta_{\vartheta}=2, \zeta_{\varphi}=0.15, v^*=0.3$ м/с. Траектория движения сфероробота показана на рисунке~\ref{generalTrajectory} сплошной линией.

Ссылки на видео!!!

\begin{figure}[h]
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=0.9\linewidth]{generalGamma.eps} \\ а)}
\end{minipage}
\hfill
\begin{minipage}[h]{0.49\linewidth}
\center{\includegraphics[width=0.9\linewidth]{generalAlpha.eps} \\ б)}
\end{minipage}
\caption{Проекции $\gamma_3$ (а) и $\alpha_1$ (б) для экспериментов с обратной связью (сплошная линия) и без (штриховая линия)}
\label{feedback_general}
\end{figure}

\begin{figure}[!h]
\centering\includegraphics[width=0.5\linewidth]{generalTrajectory.eps}
\caption{Траектория движения сфероробота комбинированного типа по прямой c преодолением препятствия: сплошная линия -- движение при $\zeta_{\vartheta}=2, \zeta_{\varphi}=0.15, v^*=0.3$ м/с, штриховая линия -- движение при $\zeta_{\vartheta}=0, \zeta_{\varphi}=0, v^*=0.3$ м/с (без обратной связи)\label{generalTrajectory}}
\end{figure}

Сравним интегральные ошибки компонент $\gamma_3$ и $\alpha_1$ для экспериментов с обратной связью и без нее. Для экспериментов с обратной связью $\sigma_{\gamma_3}=0.042$, $\sigma_{\alpha_1}=0.031$; а для экспериментов без обратной связи $\sigma_{\gamma_3}=0.076$, $\sigma_{\alpha_1}=0.179$. Что подтверждает, что движение с рассмотренным видом обратной связи более устойчивое, чем без нее.

\section{Заключение}

\qquad В заключении опишем основные результаты исследований, проведенных в данной работе и сделанные выводы.


\begin{enumerate}

\item Регулятор, описанный в работах \cite{ComboSpheroFeedback1, ComboSpheroFeedback2}, преобразован с учетом специфики технической реализации:

\begin{enumerate}
\item ограниченность максимального момента на валу двигателя
\item управление током в явном виде
\end{enumerate}

\item Найдены оптимальные значения коэффициентов $\zeta_{\vartheta}$ и $\zeta_{\varphi}$
\item Для найденных значений проведены эксперименты, дана оценка погрешности.



\item Причины погрешностей

\begin{enumerate}
\item Погрешность определяется скоростью и ориентацией + задержки
\item Неидеальность конструкции, возможное смещение центра масс, люфты, зазоры в передачах
\end{enumerate}

\item Трение не учитывается но влияет.

\end{enumerate}




\begin{thebibliography}{99}

\bibitem{OmniwheelSphero}
Karavaev Y. L., Kilin A. A., The Dynamics and Control of a Spherical Robot with an Internal Omniwheel Platform, Regular and Chaotic Dynamics, 2015, vol. 20, no. 2, pp. 134-152

\bibitem{ComboSphero}
Килин А. А., Караваев Ю. Л., Экспериментальные исследования динамики сферического робота комбинированного типа, Нелинейная динамика, 2015, т. 11, \No 4, с. 721-734

\bibitem{ComboSpheroTheory}
Kilin A.A., Pivovarova E.N., Ivanova T.B. Spherical robot of combined type: Dynamics and control // Regul. Chaotic Dyn., 2015, vol.20, no.6, pp.716-728.

\bibitem{ComboSpheroFeedback1}
Ivanova T. B., Kilin A. A., Pivovarova E. N. Controlled Motion of a Spherical Robot with Feedback. I //Journal of Dynamical and Control Systems. – 2017. – С. 1-14. https://doi.org/10.1007/s10883-017-9390-7

\bibitem{ComboSpheroFeedback2}
Ivanova T. B., Kilin A. A., Pivovarova E. N. Controlled Motion of a Spherical Robot with Feedback. II //Journal of Dynamical and Control Systems. – 2017. – С. 1-16. https://doi.org/10.1007/s10883-017-9387-2

\bibitem{Pololu}
Pololu Robotics'n'Electronics [Электронный ресурс] // URL: https://www.pololu.com/product/1443/faqs

\end{thebibliography}

\end{document} 