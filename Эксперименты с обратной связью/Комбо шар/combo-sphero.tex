\documentclass[10pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[russian]{babel}
\usepackage{amsmath,amssymb,amscd, amsfonts,amsthm}
%\usepackage{cite}
\usepackage{graphicx}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
%\usepackage{rcdcom}
\graphicspath{{pictures/}}

\newcommand{\bs}{\boldsymbol}
\newcommand{\bV}{\bs V}
\newcommand{\bF}{\bs F}
\newcommand{\bOm}{\bs\Omega}
\newcommand{\bK}{\bs K}
\newcommand{\bQ}{\bs Q}
\newcommand{\bR}{\bs R}
\newcommand{\bN}{\bs N}
\newcommand{\x}{\times}
\newcommand{\lm}{\lambda}
\newcommand{\Om}{\Omega}
\newcommand{\om}{\omega}
\newcommand{\q}{\quad}

\begin{document}

\bigskip
\begin{center}
{\Large \bf Управление комбинированным сферороботом с обратной связью}
\end{center}

\section{Введение}

\qquad На сегодняшний день существует большое количество работ, посвященных сферическим роботам. Подробные обзоры конструкций и принципов приведения в движение можно найти в работах \cite{OmniwheelSphero}. Наиболее популярными способами реализации движения сферических роботов являются изменение положения центра масс и изменение внутреннего гиростатического момента. 

Теоретические исследования динамики сфероробота комбинированного типа, использующего для движения как смещение центра масс, так и изменение гиростатического момента, катящегося без проскальзывания по горизонтальной плоскости, проведены в работе \cite{ComboSpheroTheory}. В работе \cite{ComboSphero} были проведены экспериментальные исследования, была доказана возможность управления сферическим роботом комбинированного типа. При проведении экспериментов было отмечено, что введение в систему управления обратных связей позволит повысить эффективность управления и устойчивость движения. Теоретическое исследование модели управления сфероробота комбинированного типа с обратной связью, рассмотрена в работе \cite{}, также было проведено компьютерное моделирование движения, которое показало эффективность предложенной модели. В предлагаемом подходе обратная связь зависит от фазовых переменных (текущего положения, скоростей) и не зависит от конкретного вида траектории. В данной работе мы проведем экспериментальные исследования, на основе теоретических данных введем в систему управления обратные связи и покажем как это влияет на движение сфероробота.


\section{Экспериментальное исследование движения сфероробота с обратными связями}

\qquad  Рассмотрим уравнения определяющие обратную связь в виде управляющих моментов $K_{\vartheta}$ и $K_{\varphi}$  

\begin{equation}
K_{\vartheta} = \tilde{k_{\vartheta}}(\dot{\vartheta} + \frac{v^*}{R_s}), \quad
K_{\varphi} = \tilde{k_{\varphi}}(\bOm, e_2+e_3).
\label{torque_wheels}
\end{equation}

где $\tilde{k_{\vartheta}}, \tilde{k_{\varphi}}$ -- постоянные коэффициенты, $\vartheta$ -- угол поворота маятника вокруг оси $e_1$ в подвижной системе координат, 
%$\varphi$ -- угол поворота ротора вокруг оси $e_3$ в подвижной системе координат, 
$R_s$ -- радиус сферической оболочки, $v^*$ -- заданное значение линейной скорости качения сфероробота после стабилизации движения, $\bOm$ -- угловая скорость вращения оболочки.

Данные уравнения предполагают линейную зависимость необходимых моментов от отклонения фазовых переменных. В действительности же мы ограничены максимальным моментом двигателя, приводящего в движения тот или иной компонент сфероробота. Поэтому перепишем уравнения (\ref{torque_wheels}) в следующем виде

\begin{equation}
K_{\vartheta} = \frac{2 K_{max}}{\pi}arctg((\dot{\vartheta}+\frac{v^*}{R_s})\zeta_{\vartheta}), \quad
K_{\varphi} = \frac{2 K_{max}}{\pi}arctg((\bOm, e_2+e_3)\zeta_{\varphi}).
\end{equation}

где $\zeta_{\vartheta}, \zeta_{\varphi}$ -- коэффициенты наклона графика, $K_{max}$ -- максимальный момент, обеспечиваемый двигателем.

\subsection{Движение по прямой}

\qquad Рассмотрим движение сфероробота по прямолинейной траектории с небольшим препятствием, преодолевая которое, сфероробот начинает раскачиваться. Препятствие представляет собой ступеньку высотой в 5 мм и длиной 600 мм. В данных экспериментах рассмотрено только уравнение момента $K_{\vartheta}$, так как раскачивание сфероробота происходит по ходу движения. Проведены 3 эксперимента для движения с обратной связью и 3 эксперимента для движения без обратной связи. Радиус сферы $R_s=0.15$ м. В первой серии экспериментов задавались следующие параметры: $\zeta_{\vartheta}=1, \zeta_{\varphi}=0, v^*=0.3$ м/с. Во второй серии экспериментов: $\zeta_{\vartheta}=0, \zeta_{\varphi}=0, v^*=0.3$ м/с.

Анализ экспериментов проводился по проекции вектора $\gamma$ на ось $Z$ в неподвижной системе координат. Графики, отображающие проекции вектора $\gamma$ на ось $Z$ в неподвижной системе координат для трех экспериментов движения сфероробота с обратной связью показаны на рисунке \ref{exp1_withFB}. Аналогичные графики для экспериментов без обратной связи -- на рисунке \ref{exp1_withoutFB}.

\begin{figure}[!h]
\centering\includegraphics[width=1\linewidth]{exp1_withFB.eps}
\caption{Проекции вектора $\gamma$ на ось $Z$. Эксперименты с обратной связью.\label{exp1_withFB}}
\end{figure}

\begin{figure}[!h]
\centering\includegraphics[width=1\linewidth]{exp1_withoutFB.eps}
\caption{Проекции вектора $\gamma$ на ось $Z$. Эксперименты без обратной связи.\label{exp1_withoutFB}}
\end{figure}

Среднее отклонение проекции вектора $\gamma$ от 1 для трех экспериментов с обратной связью составило $\left<\sigma\right>_{av}=0.039$, а для экспериментов без обратной связи $\left<\sigma\right>_{av}=0.078$. Это показывает, что движение с обратной связью более устойчивое, чем без нее.


%В экспериментах на последнем видео $\tilde{k_{\vartheta}}=100$. По идее от него должна зависеть линейная скорость, но она зависит еще от чего-то, может от заряда батареи, может еще от чего. В разные дни старался выбирать этот коэффициент таким, чтобы двигаться с одной скоростью (на глаз), он был равен от 60 до 100. $\dot{\vartheta}$ -- это угловая скорость тележки. Ее я считаю с энкодера одного из колес, перевожу в рад/с и умножаю на коэффициент $\frac{R_{wheel}}{R_{sphero\_internal}}=\frac{18}{145}=0.124138$, и в формуле беру ее со знаком минус. Выражение $\frac{v^*}{R_S}$ заменяю одним числом, в экспериментах на видео оно было равно 10. В итоге в моей программе уравнение момента принимает следующий вид:

%\begin{equation}
%K_{\vartheta} = \tilde{k_{\vartheta}}(-\dot{\vartheta} + v^*)=100(-\dot{\vartheta}+10),
%\label{torque_wheels_code}
%\end{equation}

%При расчете момента ротора второе уравнение (\ref{torque_wheels}) принимает вид:

%\begin{equation}
%K_{\varphi} = \tilde{k_{\varphi}}(\omega_2 - \dot{\vartheta} + \omega_3 - 0.1*\dot{\varphi}).
%\label{torque_wheels_code}
%\end{equation}

%Здесь я ввел еще один коэффициент 0.1 перед угловой скоростью ротора, так как она давала намного больший вклад. Здесь $\tilde{k_{\varphi}}=200$, $\omega_2$ и $\omega_3$ это компоненты  угловой скорости измеренные с помощью MPU9250 по соответсвующим осям: $\omega_2$ -- угловая скорость относительно оси, вдоль которой производится движение, $\omega_3$ -- угловая скорость относительно оси $Z$. $\dot{\vartheta}$ -- это угловая скорость колеса, считается по энкодеру и переводится в рад/с. Аналогично $\dot{\varphi}$ -- угловая скорость ротора, считается по энкодеру и переводится в рад/с. Угловую скорость колес $\dot{\vartheta}$ я не учитываю, так как это приводит к равномерному вращению ротора, поэтому в расчете момента $K_{\varphi}$ значение $\dot{\vartheta}=0$.

%Далее полученные моменты без коэффициентов устанавливают заданный ток на каждый двигатель. К этому значению тока двигатель выходит с помощью П регулятора. На регуляторах и колес, и ротора пропорциональный коэффициент равен 0.01, коэффициенты дифференциальной и интегральной составляющих равны 0.

%Измерения тока проводятся с частотой 20 КГц, для каждого двигателя берется среднее значение из 50 измерений. Далее это значение тока подается на вход соответствующего П регулятора, на выходе получаем изменение скважности ШИМ сигнала. Таки образом регулятор работает на частоте 400 Гц. Обновление заданого момента на двигателях происходит с частотой 50 Гц.

\begin{thebibliography}{99}

\bibitem{OmniwheelSphero}
Karavaev Y. L., Kilin A. A., The Dynamics and Control of a Spherical Robot with an Internal Omniwheel Platform, Regular and Chaotic Dynamics, 2015, vol. 20, no. 2, pp. 134-152

\bibitem{ComboSphero}
Килин А. А., Караваев Ю. Л., Экспериментальные исследования динамики сферического робота комбинированного типа, Нелинейная динамика, 2015, т. 11, \No 4, с. 721–734

\bibitem{ComboSpheroTheory}
Kilin A.A., Pivovarova E.N., Ivanova T.B. Spherical robot of combined type: Dynamics and control // Regul. Chaotic Dyn., 2015, vol.20, no.6, pp.716–728.



\end{thebibliography}

\end{document} 